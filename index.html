<!DOCTYPE html>


<!--suppress ALL -->
    <html>

    <head>

        <meta charset="UTF-8">

        <title>Red Cross</title>



        <style type="text/css">

            #content{

                width: 25%;

                margin: 20px auto;

                border: 1px solid #cbcbcb;



            }



            #grad {

                background-image: linear-gradient(to bottom, #ffffff , #e6e6e6);

            }

            .loader {
                border: 16px solid #f3f3f3;
                border-radius: 50%;
                border-top: 16px solid #3498db;
                width: 120px;
                height: 120px;
                -webkit-animation: spin 2s linear infinite; /* Safari */
                animation: spin 2s linear infinite;
            }

            /* Safari */
            @-webkit-keyframes spin {
                0% { -webkit-transform: rotate(0deg); }
                100% { -webkit-transform: rotate(360deg); }
            }

            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }

        </style>





    </head>





    <header>



        <link rel="stylesheet" href="footer.css">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">

        <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">

        <script src="https://www.gstatic.com/firebasejs/6.6.0/firebase-app.js"></script>

        <script src="https://www.gstatic.com/firebasejs/6.6.0/firebase-auth.js"></script>
    
        <script src="https://www.gstatic.com/firebasejs/6.6.0/firebase-database.js"></script>
<!--        <script src="https://www.gstatic.com/firebasejs/6.6.0/firebase.js"></script>-->



        <script src="https://cdn.firebase.com/libs/firebaseui/4.2.0/firebaseui.js"></script>

        <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/4.2.0/firebaseui.css" />



        <script src="bundle.js"></script>



<!--        <script src="app.js"></script>-->

        <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    </header>

    <img src='images/LogoRC.png' style='display: block; margin-left: auto; margin-right: auto; text-align: center; width:250px; height:250px;'/>





    <body id = "grad" style="background-color:#ffffff;">



    <div id = "error_type"> </div>



    <h1 id="title" style="display: block; margin-left: auto; margin-right: auto; text-align: center; margin-top: 100px">Login</h1>










    <div id="firebaseui-auth-container" style = "display: block; margin-left: auto; margin-right: auto; text-align: center;"></div>
    <br><br><br><br><br>
    <div class="loader" id="PreLoaderBar" style="display: block; margin-left: auto; margin-right: auto; text-align: center"></div>
<br><br><br><br>
    <script type="text/javascript">
        // FirebaseUI config.
        var locToGo = '';
        var uiConfig = {

            //signInSuccessUrl:false,
            callbacks: {
                signInSuccessWithAuthResult: function(authResult, redirectUrl) {
                     var user = authResult.user;
                    // var credential = authResult.credential;
                    // var isNewUser = authResult.additionalUserInfo.isNewUser;
                    // var providerId = authResult.additionalUserInfo.providerId;
                    // var operationType = authResult.operationType;

                    //alert(user);

                    document.getElementById('title').style.display = 'none';
                    document.getElementById('PreLoaderBar').style.display = 'flex';





                    var favoritemovie = user.uid;
                    var isUserAdmin;
                    //alert(user.uid);
                    localStorage.setItem("favoriteMovie", favoritemovie);

                    if (favoritemovie === "27t8hbCsGBMCBDXWyioPT5bqfkK2") {
                        if ((!window.location.href.includes("fullaccess.html"))) {
                            isUserAdmin = "2";
                            localStorage.setItem("isUAdmin", isUserAdmin);
                            window.location.href = 'fullaccess.html';
                            //locToGo = 'fullaccess.html';
                        }
                    } else {

                        firebase.database().ref('user/' + favoritemovie).once('value', (snapshot) => {
                            var data = snapshot.val();
                            //alert(user.uid);
                            if (snapshot.exists()) {
                                //for (let key in data) {
                                    if (data["Admin"] === 1) {
                                        if ((!window.location.href.includes("admin.html")) && (!window.location.href.includes("reports.html"))) {
                                            isUserAdmin = "1";
                                            localStorage.setItem("isUAdmin", isUserAdmin);
                                            window.location.href = 'admin.html';
                                            //locToGo = 'admin.html';
                                        }
                                    } else {
                                        isUserAdmin = "0";
                                        localStorage.setItem("isUAdmin", isUserAdmin);
                                        logout();
                                        alert("You are not an admin!");
                                        document.getElementById('PreLoaderBar').style.display = 'none';
                                        window.location.href = 'index.html';
                                        //locToGo = 'index.html';
                                    }
                                //}
                            } else {
                                isUserAdmin = "0";
                                localStorage.setItem("isUAdmin", isUserAdmin);
                                logout();
                                alert("You are not an admin!");
                                document.getElementById('PreLoaderBar').style.display = 'none';
                                window.location.href = 'index.html';
                                //window.location.href = 'index.html';
                                //locToGo = 'index.html';
                            }
                        })
                    }

                    return true;
                },
                signInFailure: function(error) {
                    // Some unrecoverable error occurred during sign-in.
                    // Return a promise when error handling is completed and FirebaseUI
                    // will reset, clearing any UI. This commonly occurs for error code
                    // 'firebaseui/anonymous-upgrade-merge-conflict' when merge conflict
                    // occurs. Check below for more details on this.
                    return handleUIError(error);
                },
                uiShown: function() {
                    // The widget is rendered.
                    // Hide the loader.
                    document.getElementById('PreLoaderBar').style.display = 'none';
                }
            },

            signInSuccessUrl: locToGo,

            signInOptions: [
                {
                    provider: firebase.auth.PhoneAuthProvider.PROVIDER_ID,

                    recaptchaParameters: {

                        type: 'image', // 'audio'

                        size: 'normal', // 'invisible' or 'compact'

                    },

                    defaultCountry: 'LB',
                }
            ]
        };



        //alert(window.location.href);

        // Initialize the FirebaseUI Widget using Firebase.

        var ui = new firebaseui.auth.AuthUI(firebase.auth());

        // The start method will wait until the DOM is loaded.

        ui.start('#firebaseui-auth-container', uiConfig);



    </script>




    </body>






    <footer class="footer-basic-centered" style="margin-top: 150px; background-color:#e6e6e6; bottom: 0; width: 100%">

 

        <p class="footer-company-motto" style = "color: #000000">Lebanese Red Cross</p>

                                  

        <div class="container2" style="margin-top:10px;">



                     <div class="b">

                    

                     <p style="color:#000000;font-family:Tahoma;text-align:left;font-size: 16px;">Per Humanitatem ad Pacem - With Humanity, Towards Peace</p>

                     <br><br>

                     <p style="color:#000000;font-family:Tahoma;text-align:left;font-size: 16px;"><a href="mailto:ahmad_kassabieh@msn.com" style="text-decoration: none;color:#000000;">ahmad_kassabieh@msn.com</a><br>

                     Lebanese Red Cross</p>

                    

                     </div>

                    

                     

                     <div class="a">

                    

                     <img src='images/LogoRC.png' style="width:150px; height: 150px;"></img>

                     <br>

                     <a  style="color:#000000;" href="https://www.facebook.com/ahmad.kassabieh.3"><i class="icon-facebook">&nbsp</i></a>



                     <a style="color:#000000;" href="https://www.instagram.com/ahmadkassabieh/"><i class="fab fa-instagram">&nbsp</i></a>

                    

                     <a style="color:#000000;" href="https://github.com/"><i class="icon-github"></i></a><br><br>

                

                     </div>

                    

        </div>

       

        <br><br>

        <p class="footer-company-name" style="color: black">Lebanese Red Cross &copy; 2019. All Rights Reserved.</p>



</footer>











    </html>

